<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual Técnico de Emergencias</title>
    <!-- Tailwind CSS para el diseño -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React y Babel para ejecutar JSX en el navegador -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .animate-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Componente de Iconos adaptado para CDN
        const Icon = ({ name, className = "w-6 h-6" }) => {
            useEffect(() => {
                lucide.createIcons();
            }, [name]);
            return <i data-lucide={name} className={className}></i>;
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('theory');
            const [selectedCategory, setSelectedCategory] = useState(null);
            const [quizState, setQuizState] = useState({
                currentQuestion: 0,
                score: 0,
                showResults: false,
                feedback: null
            });

            const categories = [
                {
                    id: 'trauma_grave',
                    title: 'Traumas Graves',
                    icon: "shield-alert",
                    color: 'bg-red-700',
                    content: [
                        { name: 'TCE (Craneoencefálico)', desc: 'Golpe en la cabeza con posible pérdida de conciencia, vómitos en escopeta o pupilas desiguales.', action: 'Mantener el eje cabeza-cuello-tronco. Vigilar nivel de consciencia continuamente.' },
                        { name: 'Trauma Abdominal', desc: 'Golpe fuerte en abdomen con dolor intenso, rigidez (vientre en tabla) o signos de shock.', action: 'Colocar en posición de decúbito supino con piernas flexionadas para relajar la musculatura.' },
                        { name: 'Fractura de Pelvis', desc: 'Suele ocurrir en atropellos o caídas de gran altura. Dolor agudo en la cadera e imposibilidad de mover las piernas.', action: 'Inmovilización absoluta. No intentar mover las piernas ni rotar al paciente.' }
                    ]
                },
                {
                    id: 'trafico',
                    title: 'Accidentes de Tráfico',
                    icon: "car",
                    color: 'bg-slate-700',
                    content: [
                        { name: 'Latigazo Cervical', desc: 'Lesión por hiperextensión e hiperflexión brusca del cuello.', action: 'Mantener alineación manual de la cabeza. No mover si no hay riesgo inminente.' },
                        { name: 'Trauma Torácico', desc: 'Golpe contra el volante o cinturón. Puede causar fracturas costales o neumotórax.', action: 'Controlar la respiración. Colocar en posición semisentado si está consciente.' },
                        { name: 'Víctima Atrapada', desc: 'Situación donde el ocupante no puede salir por deformidad del vehículo.', action: 'Aplicar protocolo PAS. Estabilizar el vehículo y esperar a bomberos.' }
                    ]
                },
                {
                    id: 'trauma_comun',
                    title: 'Traumas Comunes',
                    icon: "bone",
                    color: 'bg-blue-500',
                    content: [
                        { name: 'Fracturas', desc: 'Rotura parcial o total de un hueso. Pueden ser abiertas (hueso visible) o cerradas.', action: 'Inmovilizar sin reducir y vigilar pulso distal.' },
                        { name: 'Esguinces', desc: 'Distensión o rotura de ligamentos en una articulación.', action: 'Protocolo RICE: Reposo, Hielo, Compresión, Elevación.' },
                        { name: 'Luxaciones', desc: 'Desplazamiento de un hueso fuera de su articulación.', action: 'Inmovilizar en la posición hallada. Nunca intentar colocar el hueso.' }
                    ]
                },
                {
                    id: 'patologias',
                    title: 'Patologías Médicas',
                    icon: "brain",
                    color: 'bg-red-500',
                    content: [
                        { name: 'Ictus (AVC)', desc: 'Interrupción del flujo sanguíneo al cerebro. Síntomas: parálisis facial, habla confusa.', action: 'Identificación rápida (Escala FAST) y traslado urgente.' },
                        { name: 'IAM (Infarto)', desc: 'Obstrucción coronaria. Dolor opresivo en el pecho irradiado a brazo o mandíbula.', action: 'Reposo absoluto y aviso inmediato al 112.' }
                    ]
                }
            ];

            const quizQuestions = [
                {
                    scenario: "Tras una caída de 3 metros, el paciente no puede mover las piernas y refiere dolor insoportable en la zona de la cadera.",
                    options: ["Luxación de fémur", "Fractura de pelvis", "Esguince lumbar"],
                    correct: 1,
                    explanation: "El mecanismo de caída y la imposibilidad de movimiento en miembros inferiores sugieren fractura de pelvis."
                },
                {
                    scenario: "Un conductor golpea su cabeza contra el parabrisas. Está confundido y ha vomitado de forma violenta una vez.",
                    options: ["Ataque de ansiedad", "Migraña por estrés", "Traumatismo Craneoencefálico (TCE)"],
                    correct: 2,
                    explanation: "Los vómitos en 'escopeta' y la confusión tras un impacto craneal son signos de alarma de TCE grave."
                },
                {
                    scenario: "Un operario presenta el abdomen muy duro al tacto ('vientre en tabla') y palidez extrema tras un impacto.",
                    options: ["Indigestión", "Traumatismo abdominal interno", "Rotura de fibras"],
                    correct: 1,
                    explanation: "La rigidez abdominal (vientre en tabla) es un signo clásico de hemorragia o trauma interno grave."
                }
            ];

            const handleAnswer = (index) => {
                const isCorrect = index === quizQuestions[quizState.currentQuestion].correct;
                setQuizState({ ...quizState, feedback: isCorrect ? 'correct' : 'incorrect' });

                setTimeout(() => {
                    if (quizState.currentQuestion + 1 < quizQuestions.length) {
                        setQuizState({
                            ...quizState,
                            currentQuestion: quizState.currentQuestion + 1,
                            score: isCorrect ? quizState.score + 1 : quizState.score,
                            feedback: null
                        });
                    } else {
                        setQuizState({
                            ...quizState,
                            score: isCorrect ? quizState.score + 1 : quizState.score,
                            showResults: true,
                            feedback: null
                        });
                    }
                }, 1500);
            };

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <div className="max-w-5xl mx-auto">
                        <header className="mb-8 text-center">
                            <h1 className="text-3xl font-bold text-slate-800 mb-2 flex items-center justify-center gap-2">
                                <Icon name="activity" className="text-red-600 w-8 h-8" />
                                Manual Técnico de Emergencias
                            </h1>
                            <p className="text-slate-500 italic">Recurso Educativo para Grado Medio</p>
                        </header>

                        <div className="flex mb-6 bg-white p-1 rounded-xl shadow-sm border border-slate-200">
                            <button 
                                onClick={() => setActiveTab('theory')}
                                className={`flex-1 py-3 rounded-lg flex items-center justify-center gap-2 transition-all font-bold ${activeTab === 'theory' ? 'bg-indigo-600 text-white shadow-md' : 'text-slate-600 hover:bg-slate-50'}`}
                            >
                                <Icon name="book-open" className="w-4 h-4" /> Protocolos
                            </button>
                            <button 
                                onClick={() => setActiveTab('quiz')}
                                className={`flex-1 py-3 rounded-lg flex items-center justify-center gap-2 transition-all font-bold ${activeTab === 'quiz' ? 'bg-indigo-600 text-white shadow-md' : 'text-slate-600 hover:bg-slate-50'}`}
                            >
                                <Icon name="check-circle" className="w-4 h-4" /> Autoevaluación
                            </button>
                        </div>

                        {activeTab === 'theory' && (
                            <div className="space-y-4 animate-in">
                                <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                                    {categories.map((cat) => (
                                        <button
                                            key={cat.id}
                                            onClick={() => setSelectedCategory(cat)}
                                            className={`p-5 rounded-2xl border-2 transition-all text-left flex flex-col gap-3 h-full ${selectedCategory?.id === cat.id ? 'border-indigo-500 bg-indigo-50' : 'border-transparent bg-white shadow-sm hover:shadow-md'}`}
                                        >
                                            <div className={`${cat.color} text-white p-3 rounded-xl w-fit`}>
                                                <Icon name={cat.icon} />
                                            </div>
                                            <h3 className="font-bold text-sm leading-tight">{cat.title}</h3>
                                        </button>
                                    ))}
                                </div>

                                {selectedCategory && (
                                    <div className="bg-white p-6 rounded-2xl shadow-lg border border-slate-100 animate-in">
                                        <h2 className="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                                            <div className={`${selectedCategory.color} p-2 rounded-lg text-white`}><Icon name={selectedCategory.icon} /></div>
                                            {selectedCategory.title}
                                        </h2>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            {selectedCategory.content.map((item, idx) => (
                                                <div key={idx} className="p-4 bg-slate-50 rounded-xl border border-slate-200">
                                                    <h4 className="font-bold text-indigo-900 mb-1">{item.name}</h4>
                                                    <p className="text-slate-600 text-xs mb-3">{item.desc}</p>
                                                    <div className="bg-white p-3 rounded-lg border-l-4 border-emerald-500 flex items-start gap-2">
                                                        <Icon name="info" className="text-emerald-600 w-4 h-4" />
                                                        <p className="text-xs text-slate-700"><strong>Actuación:</strong> {item.action}</p>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {activeTab === 'quiz' && (
                            <div className="bg-white p-6 md:p-10 rounded-3xl shadow-xl border border-slate-100 animate-in min-h-[400px]">
                                {!quizState.showResults ? (
                                    <div>
                                        <div className="mb-8">
                                            <p className="text-xs font-bold text-indigo-600 uppercase tracking-widest mb-1">Pregunta {quizState.currentQuestion + 1}</p>
                                            <h2 className="text-xl font-bold text-slate-800 italic">"{quizQuestions[quizState.currentQuestion].scenario}"</h2>
                                        </div>
                                        <div className="space-y-3">
                                            {quizQuestions[quizState.currentQuestion].options.map((option, idx) => (
                                                <button
                                                    key={idx}
                                                    disabled={quizState.feedback !== null}
                                                    onClick={() => handleAnswer(idx)}
                                                    className={`w-full p-4 rounded-xl border-2 text-left transition-all flex justify-between items-center
                                                        ${quizState.feedback === null ? 'border-slate-100 hover:border-indigo-400' : 
                                                        idx === quizQuestions[quizState.currentQuestion].correct ? 'border-emerald-500 bg-emerald-50' : 'border-slate-50'}`}
                                                >
                                                    <span className="font-bold">{option}</span>
                                                    {quizState.feedback !== null && idx === quizQuestions[quizState.currentQuestion].correct && <Icon name="check" className="text-emerald-500" />}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                ) : (
                                    <div className="text-center py-10 animate-in">
                                        <div className="text-6xl font-black text-indigo-600 mb-4">{Math.round((quizState.score / quizQuestions.length) * 100)}%</div>
                                        <p className="text-slate-500 mb-8 font-bold text-xl">Evaluación Finalizada</p>
                                        <button onClick={() => setQuizState({ currentQuestion: 0, score: 0, showResults: false, feedback: null })} className="bg-slate-900 text-white px-8 py-3 rounded-xl font-bold">Reiniciar Test</button>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
